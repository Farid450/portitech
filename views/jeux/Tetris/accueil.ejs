<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TETRIS</title>
    <script src="../../../javascripts/Tetris/phaser.min.js"></script>
</head>

<body style="margin:0px auto;">
<header><% include ../../partials/header %></header>
HELLO WORLD

<div align="center">
    <script>

        var game = new Phaser.Game(160, 320, Phaser.AUTO, 'Tetris', { preload: preload, create: create, update: update });

        console.log(grid);
        function preload() {
            game.load.spritesheet('tetrominos', '../../../images/tetris/Tetrominos.png',32,16);
            //game.load.spritesheet('bg', '../../../images/tetris/Grid.png');
            console.log('preload');
        }
        function create() {

           // this.game.time.events.loop(125, this.updateStrength, this);


            //BackgroundSprite = game.add.tileSprite(0,0,game.width,game.height,'bg')
            player = game.add.sprite(40, 0, 'tetrominos');

            game.physics.arcade.enable(player);

            //  Player physics properties. Give the little guy a slight bounce.
            player.body.bounce.y = 0;
            player.body.bounce.x = 0;
            player.body.gravity.y = 50;
            player.body.collideWorldBounds = true;

            //  Our two animations, walking left and right.
           // player.animations.add('left', [0, 1, 2, 3], 10, true);
           // player.animations.add('right', [5, 6, 7, 8], 10, true);

            console.log('create');
        }
        var cpt = 0;
             function update(){
           cpt++;
           if (cpt == 500){
               player.body.y += 16;
               cpt =0;
           }



            cursors = game.input.keyboard.createCursorKeys();

            //  Reset the players velocity (movement)
            player.body.velocity.x = 0;

            if (cursors.left.isDown)
            {
                //  Move to the left
                player.body.x += 8;
            }
            if (cursors.right.isDown)
            {
                //  Move to the right
                player.body.x -= 8;

            }


            if (cursors.up.isDown){


                game.add.tween(player).to( { angle: 90 }, 1, Phaser.Easing.Circular.none, true);

            }
            else if( cursors.up.isUp){

            }
            if(cursors.down.isDown){
                player.body.y += 16;
            }
            console.log('update');

            if( player.body.touching.down == true){
                player.body.allowRotation = false;

            }
        }

    </script>
</div>
<input type = "submit" onclick="CalculScore(50,'tetris',1200)">envoye-ton score</input>
</body>
</html>